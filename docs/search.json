[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Biostatistics in Public Health",
    "section": "",
    "text": "Preface"
  },
  {
    "objectID": "sessions/descriptive_stats.html#continuous-outcomes",
    "href": "sessions/descriptive_stats.html#continuous-outcomes",
    "title": "1  Descriptive Statistics",
    "section": "1.1 Continuous outcomes",
    "text": "1.1 Continuous outcomes\n\n1.1.1 Summary statistics\nTo generate the commonly used summary statistics in R, you can follow these steps:\n\nUsing the summarize function: The summary function displays summary statistics (observations, mean standard deviation, minimum and maximum).\n\nNB: The specific column (variable) for the summary statistics can be specified or R will perform the summary statistics for all the variables in the dataset as shown below.\n\nStOB &lt;- readxl::read_xlsx('../data/Sample.xlsx')\n\nStOB\n\n# A tibble: 95 × 16\n       UID   Age   BMI Smoker   CVD Outcome Diabetic   DBP Education Glucose\n     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 4343801    60  24.7      0     0       0        0  79           1      78\n 2 8699070    49  24.7      0     1       1        0  82           2      60\n 3 5169197    55  28.9      0     1       1        0  80           4      68\n 4 4111268    61  26.8      0     0       1        0  74           2      91\n 5 9062570    52  23.1      1     0       0        0  70           2      61\n 6 6793529    50  20.7      1     0       0        0  72.5         2      77\n 7  621362    52  24.6      0     0       1        1  89           3      73\n 8 9059122    55  20.7      0     0       1        0  87           4      71\n 9 5081457    42  23.7      1     0       0        0  72           3     100\n10 7796482    41  27.8      1     0       0        0 100           2      71\n# ℹ 85 more rows\n# ℹ 6 more variables: Heart &lt;dbl&gt;, Hypertension &lt;dbl&gt;, Sex &lt;dbl&gt;, Stroke &lt;dbl&gt;,\n#   SBP &lt;dbl&gt;, Cholestrol &lt;dbl&gt;\n\n\n\nStOB |&gt; summary()\n\n      UID               Age             BMI            Smoker      \n Min.   :  12629   Min.   :35.00   Min.   :18.18   Min.   :0.0000  \n 1st Qu.:4168547   1st Qu.:43.00   1st Qu.:23.61   1st Qu.:0.0000  \n Median :5757051   Median :52.00   Median :25.40   Median :0.0000  \n Mean   :5887138   Mean   :50.99   Mean   :25.68   Mean   :0.4526  \n 3rd Qu.:8580606   3rd Qu.:58.00   3rd Qu.:27.62   3rd Qu.:1.0000  \n Max.   :9964282   Max.   :69.00   Max.   :36.57   Max.   :1.0000  \n                                                                   \n      CVD            Outcome       Diabetic            DBP        \n Min.   :0.0000   Min.   :0.0   Min.   :0.00000   Min.   : 62.00  \n 1st Qu.:0.0000   1st Qu.:0.0   1st Qu.:0.00000   1st Qu.: 74.00  \n Median :0.0000   Median :0.0   Median :0.00000   Median : 82.00  \n Mean   :0.3158   Mean   :0.4   Mean   :0.05263   Mean   : 83.16  \n 3rd Qu.:1.0000   3rd Qu.:1.0   3rd Qu.:0.00000   3rd Qu.: 88.50  \n Max.   :1.0000   Max.   :1.0   Max.   :1.00000   Max.   :133.00  \n                                                                  \n   Education        Glucose           Heart         Hypertension   \n Min.   :1.000   Min.   : 56.00   Min.   : 50.00   Min.   :0.0000  \n 1st Qu.:1.000   1st Qu.: 73.00   1st Qu.: 65.00   1st Qu.:0.0000  \n Median :2.000   Median : 80.00   Median : 73.00   Median :1.0000  \n Mean   :1.892   Mean   : 83.28   Mean   : 73.54   Mean   :0.6947  \n 3rd Qu.:2.000   3rd Qu.: 87.00   3rd Qu.: 78.00   3rd Qu.:1.0000  \n Max.   :4.000   Max.   :294.00   Max.   :107.00   Max.   :1.0000  \n NA's   :2       NA's   :9                                         \n      Sex            Stroke            SBP          Cholestrol   \n Min.   :1.000   Min.   :0.0000   Min.   : 90.0   Min.   :157.0  \n 1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:118.2   1st Qu.:212.0  \n Median :2.000   Median :0.0000   Median :130.0   Median :235.0  \n Mean   :1.526   Mean   :0.1053   Mean   :133.7   Mean   :241.5  \n 3rd Qu.:2.000   3rd Qu.:0.0000   3rd Qu.:145.2   3rd Qu.:275.5  \n Max.   :2.000   Max.   :1.0000   Max.   :209.0   Max.   :390.0  \n                                                  NA's   :4      \n\n\nFor a specific column, the variable can be specified. In the example of summary statistics for variable age then age needs to be specified as summary(StOB$age), where StOB is the data frame and age is the variable.\n\nStOB$Age |&gt; summary()\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  35.00   43.00   52.00   50.99   58.00   69.00 \n\n\nAnother way is to install and library the package psych. Then you can call the function describe()to provide the summary statistics.\n\nStOB$Age |&gt; psych::describe()\n\n   vars  n  mean   sd median trimmed   mad min max range skew kurtosis   se\nX1    1 95 50.99 9.23     52   50.75 11.86  35  69    34 0.13    -1.16 0.95\n\n\n\n\n1.1.2 Histogram\nHistograms are typically used to display the distribution of continuous data but have adaptations for discrete data. We will focus on using this for continuous data which is usually the case. Here is a brief description of how to get this done:\nTo get a histogram, there are several ways, you may simply call the function hist(x, data, …)from the base R or use the ggplot2 package. In the example below we called the hist() function, specifying the dataset StOB and the variables Age(Age in ywaers). The col= indicates the colour, main indicate the title and xlab represent the label for the x-axis.\nExample: In the histogram below we specified the colour using col=“lightyellow” and the title *main = “Age of Patients” as well as the label for the x-axis using xlab= “Age (years)”. In ggplot2 a similar code could be used:\n\nhist(StOB$Age, col=\"green\",\n     main = \"Age of Patients\",\n     xlab= \"Age (Years)\")\n\n\n\n\nThe histogram indicates that many of the patients fell between the ages of 50 and 55.\nNB: before you can use this package make sure the package is installed and called.\n\nggplot(StOB) +\n aes(x = Age) +\n geom_histogram(bins = 7L, fill = \"green\") +\n labs(x = \"Age (Years)\", \n y = \"Freq\", title = \"Age of Patients\") +\n theme_minimal() +\n theme(plot.title = element_text(size = 15L, \n face = \"bold\", hjust = 0.5), axis.title.y = element_text(face = \"bold\"), axis.title.x = element_text(face = \"bold\"))\n\n\n\n\n\n\n1.1.3 Exercise\nRead in the sample data set and create the following visualizations:\n\nA histogram of the ages\nA scatter plot of BMI by cholesterol level\n(Bonus) A clustered bar graph of education by sex\n\n\n1.1.3.1 Answers\n\nA histogram of the ages\n\n\nggplot(StOB) +\n aes(x = BMI) +\n geom_histogram(bins = 7L, fill = \"green\") +\n labs(x = \"BMI\", \n y = \"Freq\", title = \"BMI of Patients\") +\n theme_minimal() +\n theme(plot.title = element_text(size = 15L, \n face = \"bold\", hjust = 0.5), axis.title.y = element_text(face = \"bold\"), axis.title.x = element_text(face = \"bold\"))\n\n\n\n\n\nA scatter plot of BMI by cholesterol level\n\n\nStOB |&gt; \n    ggplot(aes(x = BMI, y = Cholestrol)) +\n    geom_point() +\n    theme_minimal()\n\n\n\n\n\n(Bonus) A clustered bar graph of education by sex\n\n\nStOB |&gt; \n    drop_na(Education)|&gt; \n    mutate(Sex = if_else(Sex == 1, \"Female\", \"Male\"),\n           Education_level = case_when(\n               Education == 1 ~ \"Primary\", \n               Education == 2 ~ \"Secondary\",\n               Education == 3 ~ \"Tertiary\", \n               Education == 4 ~ \"Postgraduate\"\n           ), \n           Education_level = fct_reorder(Education_level, \n                                         Education)) |&gt; \n  group_by(Education, \n           Education_level, \n           Sex) |&gt;\n    summarise(Count = n()) |&gt;\n    ggplot(aes(x = Education_level, \n             y = Count, \n             fill = Sex)) +\n    geom_bar(position=\"dodge\", \n             stat=\"identity\") +\n    theme_minimal()"
  },
  {
    "objectID": "sessions/hypothesis_testing.html#testing-a-null-hypothesis",
    "href": "sessions/hypothesis_testing.html#testing-a-null-hypothesis",
    "title": "2  Hypothesis Testing",
    "section": "2.1 Testing a Null Hypothesis",
    "text": "2.1 Testing a Null Hypothesis\n\n2.1.1 One-sided T-test\n\nlibrary(tidyverse)\nStOB &lt;- readxl::read_xlsx('../data/Sample.xlsx')\n\nStOB\n\n# A tibble: 95 × 16\n       UID   Age   BMI Smoker   CVD Outcome Diabetic   DBP Education Glucose\n     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n 1 4343801    60  24.7      0     0       0        0  79           1      78\n 2 8699070    49  24.7      0     1       1        0  82           2      60\n 3 5169197    55  28.9      0     1       1        0  80           4      68\n 4 4111268    61  26.8      0     0       1        0  74           2      91\n 5 9062570    52  23.1      1     0       0        0  70           2      61\n 6 6793529    50  20.7      1     0       0        0  72.5         2      77\n 7  621362    52  24.6      0     0       1        1  89           3      73\n 8 9059122    55  20.7      0     0       1        0  87           4      71\n 9 5081457    42  23.7      1     0       0        0  72           3     100\n10 7796482    41  27.8      1     0       0        0 100           2      71\n# ℹ 85 more rows\n# ℹ 6 more variables: Heart &lt;dbl&gt;, Hypertension &lt;dbl&gt;, Sex &lt;dbl&gt;, Stroke &lt;dbl&gt;,\n#   SBP &lt;dbl&gt;, Cholestrol &lt;dbl&gt;\n\n\n\n2.1.1.1 Exercise\nCalculate the mean, median, and standard deviation.\n\nmean(StOB$Age)\n\n[1] 50.98947\n\nmedian(StOB$Age)\n\n[1] 52\n\nsd(StOB$Age)\n\n[1] 9.232799\n\n\nRun a t-test with a 95% confidence interval.\n\nt.test(StOB$Glucose, mu =120,\n              alternative = \"two.sided\")\n\n\n    One Sample t-test\n\ndata:  StOB$Glucose\nt = -12.513, df = 85, p-value &lt; 2.2e-16\nalternative hypothesis: true mean is not equal to 120\n95 percent confidence interval:\n 77.44428 89.11386\nsample estimates:\nmean of x \n 83.27907 \n\n\n\n\n\n2.1.2 Two Sided T-test\nExercise\nAssuming in a neighbouring community to our Sample dataset, the mean glucose level is known to be 85mg/dL and we want to test if the mean glucose level of our Sample dataset is equal to this value.\nRun a one-sample t-test at a 5% significance level for this first with all observations and then with only observations with a glucose level&lt;120mg/dL. Which of the two tests is more appropriate? Explain your answer.\n\nglucose_over_120 &lt;- StOB |&gt; \n    filter(Glucose&lt;=120) \n\n    t.test(glucose_over_120$Glucose, \n           mu =120,\n           alternative = \"two.sided\")\n\n\n    One Sample t-test\n\ndata:  glucose_over_120$Glucose\nt = -34.378, df = 81, p-value &lt; 2.2e-16\nalternative hypothesis: true mean is not equal to 120\n95 percent confidence interval:\n 76.51093 81.26956\nsample estimates:\nmean of x \n 78.89024 \n\n\n\n\n2.1.3 Analysis of Variance (ANOVA)\n\n2.1.3.1 One-way ANOVA\nOne-way ANOVA is a statistical method to test whether the means of two or more groups are equal. This can be done by using the oneway.test() or aov()function \nExample\nFrom the [Sample] dataset, assuming we want to compare the mean systolic blood pressure across categories of education at 5% significance level, we use the following:\n\none.way &lt;- aov(SBP ~ Education,data = StOB)\n\nsummary(one.way)\n\n            Df Sum Sq Mean Sq F value Pr(&gt;F)\nEducation    1    291   290.7   0.564  0.455\nResiduals   91  46898   515.4               \n2 observations deleted due to missingness\n\n\nFrom the output above, our focus is the F-statistic p-value of 0.535 which is not significant at 5% and so we fail to reject the null hypothesis of no differences in mean systolic blood pressures across education.\n\n\n2.1.3.2 Post hoc tests for One-way ANOVA\nThe one-way ANOVA does not show exactly where differences in means are so post hoc tests may be carried out to investigate those differences. R provides post hoc tests such as Bonferroni, Scheffe, or Sidak, Tukeybut we will look at the Bonferroni test which is one of the more commonly used ones. \nFrom our previous example, the function TukeyHSD()can be used for Tukey or pairwise.t.test(df$y, df$x, p.adj=‘bonferroni’)can be used for Bonferroni method.\n\npairwise.t.test(StOB$BMI, StOB$Education, p.adj='bonferroni')\n\n\n    Pairwise comparisons using t tests with pooled SD \n\ndata:  StOB$BMI and StOB$Education \n\n  1    2    3   \n2 0.61 -    -   \n3 1.00 1.00 -   \n4 1.00 1.00 1.00\n\nP value adjustment method: bonferroni \n\n\nWe can also implement using TukeyHSD()\n\nTukeyHSD(one.way, conf.level=.95)\n\nError in TukeyHSD.aov(one.way, conf.level = 0.95) : no factors in the fitted model\nExercise\nUsing the [Sample] dataset, carry out a one-way ANOVA to investigate the differences in mean cholesterol across categories of cardiovascular disease. Are these differences significant? What is the mean difference in cholesterol? Carry out a two-sample t-test on the same variables. What do you notice?\n\n\n2.1.3.3 Two-way ANOVA\nA two-way ANOVA compares the means of an outcome over two or more levels of two categorical variables. It can be used to investigate how two factors affect a response variable or whether there is an interaction effect between the two factors on the response variable.\nExample\nWe will use the [Drug trial] dataset. Suppose as a researcher you want to investigate if there are differences in mean systolic blood pressure after the intervention, across categories of the drug used and the type of disease suffered by the patient. To carry out this investigation in R using the two-way ANOVA, the syntax and output are as follows: aov(y ~ x1 + x2, data = data frame)\n\ntwo.way &lt;- aov(SBP2 ~ Drug + Disease, data = StOB)\n\nsummary(two.way)\n\nError in eval(predvars, data, env) : object ‘SBP2’ not found\nFrom the output there is a significant association between systolic blood pressure and drug type (p&lt;0.001) but not with disease (p=0.069). \n\n\n2.1.3.4 Repeated measures ANOVA\nRepeated measures ANOVA compares the means of an outcome measured repeatedly over two or more levels of categorical variables. It can be also used to examine how a response variable changes over time or under different conditions. To do a repeated measures ANOVA in RStudio:\nExample\nConsider the following data on reaction time by 5 individuals to 4 different drugs where the repeated measure is the reaction time. Create a dataset with this data and import it into R for analysis.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPerson\n1\n1\n1\n1\n2\n2\n2\n2\n3\n3\n3\n3\n4\n4\n4\n4\n5\n5\n5\n5\n\n\nDrug\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n1\n2\n3\n4\n\n\nTime\n28\n27\n15\n32\n13\n17\n9\n21\n22\n19\n16\n28\n36\n32\n18\n43\n25\n27\n12\n28\n\n\n\nThe null hypothesis is that the reaction times do not vary significantly across the different drugs. To conduct a one-way repeated measures ANOVA, the syntax and output is: \n\nlibrary(rstatix)\n\nperson &lt;- c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5)\ndrug   &lt;- c(1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4)  \ntime   &lt;- c(28,27,15,32,13,17,9,21,22,19,16,28,36,32,18,43,25,27,12,28)\nStOBrt &lt;- data.frame(person, drug, time)\n\nrt.aov &lt;- anova_test(\ndata = StOBrt, dv = time, wid = person,\nwithin = c(drug)\n)\nrt.aov\n\nANOVA Table (type III tests)\n\n$ANOVA\n  Effect DFn DFd      F        p p&lt;.05   ges\n1   drug   3  12 24.007 2.33e-05     * 0.484\n\n$`Mauchly's Test for Sphericity`\n  Effect     W    p p&lt;.05\n1   drug 0.254 0.61      \n\n$`Sphericity Corrections`\n  Effect   GGe     DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]\n1   drug 0.624 1.87, 7.49 0.000605         * 1.152 3.46, 13.83 2.33e-05\n  p[HF]&lt;.05\n1         *\n\n\nThe p-values suggest significant differences in mean reaction time across the four drugs (at 5% significance level) for the different repeated measures by person.\n\n\n2.1.3.5 Multivariate Analysis of Variance (MANOVA)\nMANOVA is an extension of the ANOVA and is used to determine if the are significant differences in the means of two or more outcome variables across one or more independent variables. To carry out a MANOVA in RStudio the function manova() can be used as follows.\n\nman_r &lt;- manova(cbind(SBP2, DBP2) ~ drug, data = StOBrt )\n\nsummary(man_r)\n\nError in eval(predvars, data, env) : object ‘SBP2’ not found\nTest statistics and degrees of freedom are shown but our focus is on the last column that lists the p-values where we can see at 5% significance level, significant differences in both systolic and diastolic blood pressures across the different drug types used in the intervention. We can therefore conclude that the different drug types used in the intervention worked differently on both systolic and diastolic blood pressure for the 60 patients. This is an example of a one-way MANOVA because we have just one-factor variable (Drug)."
  },
  {
    "objectID": "sessions/power_sample.html#using-epi-info",
    "href": "sessions/power_sample.html#using-epi-info",
    "title": "4  Power and Sample Size",
    "section": "4.1 USING EPI-INFO",
    "text": "4.1 USING EPI-INFO\n\nRun EPI6 main menu\nSelect EPITABLE CALCULATOR\nSelect SAMPLE, then SAMPLE SIZE\nSelect appropriate study design"
  },
  {
    "objectID": "sessions/power_sample.html#examples",
    "href": "sessions/power_sample.html#examples",
    "title": "4  Power and Sample Size",
    "section": "4.2 Examples",
    "text": "4.2 Examples\n\n4.2.1 Example I\nAn ophthalmologist wants to know the proportion (p) of a population with defective vision.\n\nWhat is the minimum sample size if the investigator wishes to be 95% certain that the error of estimation is within ±0.05.\n\n\n\n4.2.2 Example II\nThe incidence of on new breast cancer among women is 150 per 100,000. We want to see if the introduction of a Vitamin dose will reduce the incidence by 20%.\n\nHow large a sample do we need if we wish a significance level of 5% and a power of 80%?\n\n\n\n4.2.3 Example III\nA study to manage women of prematurely labour (20 – 36 wks).\n65% of women who use terbutaline alone and 60% who use a combination with metoprolol extend preganancy beyond 36 weeks. Results were not significant at 5% with 200 patients. How large samples per each group if:\n\nGet a larger sample\nTwice patients randomized for terbutaline alone"
  },
  {
    "objectID": "sessions/power_sample.html#study-design",
    "href": "sessions/power_sample.html#study-design",
    "title": "4  Power and Sample Size",
    "section": "4.3 Study Design",
    "text": "4.3 Study Design\n\n4.3.1 Cross-sectional study\nWedding party, 4000 guests invited. Illness because of food. Need to find the association between food and illness. 20% took pilau and the rest (80%) no pilau. So, ratio of unexposed to exposed = 80:20\n\nGuess that 10% case rate among unexposed and we need to detect an odds ratio of at least 2.\n\n\n\n4.3.2 Cohort study\nIn a vaccine trial, patients are randomly given a vaccine or a placebo. The disease among unexposed group is 10%.\n\nHow many subjects should the study enroll to receive a two-fold reduction in risk associated with immunization.\n\n\n\n4.3.3 Case-control study\nWe want to compare if diarrhea is associated with bottle feeding or not using ca-co design. Mothers with infants cases and without infant cases interviewed about feeding practices. It is expected that about 40% of controls will be bottle-fed. If we want to detect a difference if bottle-feeding was associated with a two-fold increase of diarrhea (OR=2).\n\nHow many subjects in each group?"
  }
]